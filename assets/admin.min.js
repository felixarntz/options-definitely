/*!
 * Options, Definitely - Version 0.5.0
 * 
 * Felix Arntz <felix-arntz@leaves-and-love.net>
 */
jQuery(document).ready(function(a){function b(b){var c=a(b.element);return c.data().hasOwnProperty("image")?'<div class="option-box" style="background-image:url('+c.data("image")+');"></div>'+b.text:c.data().hasOwnProperty("color")?'<div class="option-box" style="background-color:#'+c.data("color")+';"></div>'+b.text:b.text}var c={containerCss:{width:"100%","max-width":"500px"},closeOnSelect:!1,formatResult:b,formatSelection:b,escapeMarkup:function(a){return a},minimumResultsForSearch:8};a("select").select2(c);var d={lang:_wpod_admin.language,formatDate:"Y-m-d",formatTime:"H:i",dayOfWeekStart:_wpod_admin.start_of_week},e=a.extend({format:"Y-m-d H:i",onShow:function(a,b){var c="";b.attr("min")&&(c=b.attr("min").split(" "),2===c.length?this.setOptions({minDate:c[0],minTime:c[1]}):1===c.length&&this.setOptions({minDate:c[0]})),b.attr("max")&&(c=b.attr("max").split(" "),2===c.length?this.setOptions({maxDate:c[0],maxTime:c[1]}):1===c.length&&this.setOptions({maxDate:c[0]})),b.attr("step")&&this.setOptions({step:parseInt(b.attr("step"))})}},d),f=a.extend({format:"Y-m-d",timepicker:!1,onShow:function(a,b){b.attr("min")&&this.setOptions({minDate:b.attr("min")}),b.attr("max")&&this.setOptions({maxDate:b.attr("max")})}},d),g=a.extend({format:"H:i",datepicker:!1,onShow:function(a,b){b.attr("min")&&this.setOptions({minTime:b.attr("min")}),b.attr("max")&&this.setOptions({maxTime:b.attr("max")}),b.attr("step")&&this.setOptions({step:parseInt(b.attr("step"))})}},d);if(a("input.dtp-datetime").datetimepicker(e),a("input.dtp-date").datetimepicker(f),a("input.dtp-time").datetimepicker(g),a(".form-table").on("change",'input[type="range"], input[type="color"]',function(){a("#"+a(this).attr("id")+"-"+a(this).attr("type")+"-viewer").val(a(this).val())}),a(".form-table").on("change",'input[class="range-viewer"], input[class="color-viewer"]',function(){a(this).next("input").val(a(this).val())}),a(".form-table").on("click",".radio-group .radio div",function(){var b=a(this).attr("id").replace("-asset","");a(this).parent().parent().find(".radio div").removeClass("checked"),a(this).addClass("checked"),a("#"+b).prop("checked",!0)}),a(".form-table").on("change",".radio-group .radio input",function(){a(this).parent().parent().find(".radio div").removeClass("checked")}),a(".form-table").on("click",".checkbox-group .checkbox div",function(){var b=a(this).attr("id").replace("-asset","");a(this).hasClass("checked")?(a(this).removeClass("checked"),a("#"+b).prop("checked",!1)):(a(this).addClass("checked"),a("#"+b).prop("checked",!0))}),"undefined"!=typeof wp.media){var h=!0,i=wp.media.editor.send.attachment;a(".form-table").on("click",".media-button",function(){var b=a(this),c=b.attr("id").replace("-media-button","");return h=!0,wp.media.editor.send.attachment=function(b,d){return h?(a("#"+c).val(d.id),a("#"+c+"-media-title").val(d.title),"image"===d.type?a("#"+c+"-media-image").length>0?a("#"+c+"-media-image").attr("src",d.url):a("#"+c+"-media-button").after('<img id="'+c+'-media-image" class="media-image" src="'+d.url+'" />'):a("#"+c+"-media-link").length>0?a("#"+c+"-media-link").attr("href",d.url):a("#"+c+"-media-button").after('<a id="'+c+'-media-link" class="media-link" href="'+d.url+'" target="_blank">'+_wpod_admin.localized_open_file+"</a>"),void 0):i.apply(this,[b,d])},wp.media.editor.open(b),!1}),a(".add_media").on("click",function(){h=!1})}a(".repeatable").length>0&&void 0!==_wpod_admin&&a(".repeatable").each(function(){a(this).on("click",".new-repeatable-button",function(b){var d=a("#"+b.delegateTarget.id),h=parseInt(d.data("limit")),i=d.data("parent-slug")+"-"+d.data("slug"),j=d.find(".repeatable-row").length;if("undefined"!=typeof _wpod_admin.repeatable_field_templates[i]){var k=_wpod_admin.repeatable_field_templates[i].replace(/{{KEY}}/g,j).replace(/{{KEY_PLUSONE}}/g,j+1);d.append(k).find("select").select2(c),d.find("input.dtp-datetime").datetimepicker(e),d.find("input.dtp-date").datetimepicker(f),d.find("input.dtp-time").datetimepicker(g),h>0&&h===j+1&&d.find(".new-repeatable-button").hide()}b.preventDefault()}),a(this).on("click",".remove-repeatable-button",function(b){var c=a("#"+b.delegateTarget.id),d=c.find(".repeatable-row"),e=parseInt(a(this).data("number"))+1;b.preventDefault(),d.filter(":nth-child("+(e+1)+")").remove(),d.filter(":gt("+(e-1)+")").each(function(){var b=a(this),c=parseInt(b.find(".remove-repeatable-button").data("number")),d=c-1;b.find("span:first").html(b.find("span:first").html().replace((c+1).toString(),(d+1).toString())),b.find(".repeatable-col input, .repeatable-col select, .repeatable-col img, .repeatable-col a").each(function(){a(this).attr("id")&&a(this).attr("id",a(this).attr("id").replace(c.toString(),d.toString())),a(this).attr("name")&&a(this).attr("name",a(this).attr("name").replace(c.toString(),d.toString()))}),b.find(".remove-repeatable-button").data("number",d.toString())});var f=parseInt(a("#"+b.delegateTarget.id).data("limit"));f>0&&f>a("#"+b.delegateTarget.id).find(".repeatable-row").length&&a("#"+b.delegateTarget.id).find(".new-repeatable-button").show()})})});